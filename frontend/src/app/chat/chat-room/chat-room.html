<div class="flex flex-col h-screen bg-gray-50">
  <!-- 🧭 Header -->
  <div class="bg-white shadow p-4 flex justify-between items-center">
    <h2 class="text-lg font-semibold text-gray-800">
      💬 Chat Room: {{ roomId }}
    </h2>
    <span class="text-sm text-gray-500">
      Logged in as <b>{{ username }}</b>
    </span>
  </div>

  <!-- 💬 Messages Container -->
  <div
    #scrollContainer
    class="flex-1 overflow-y-auto p-4 space-y-3 bg-gray-100"
  >
    <div *ngIf="loading" class="text-center text-gray-500 mt-4">
      Loading messages...
    </div>

    <div *ngIf="!loading && messages.length === 0" class="text-center text-gray-400">
      No messages yet. Start the conversation 👋
    </div>

    <!-- 🗨️ Message bubbles -->
    <div
      *ngFor="let msg of messages"
      [ngClass]="{
        'text-right': msg.senderUsername === username,
        'text-left': msg.senderUsername !== username
      }"
    >
      <div
        [ngClass]="{
          'bg-blue-500 text-white rounded-2xl rounded-br-none inline-block px-3 py-2':
            msg.senderUsername === username,
          'bg-white text-gray-800 border border-gray-200 rounded-2xl rounded-bl-none inline-block px-3 py-2':
            msg.senderUsername !== username
        }"
      >
        <div class="text-sm break-words">
          {{ msg.content }}
        </div>
        <div class="text-xs opacity-70 mt-1">
          <span *ngIf="msg.senderUsername !== username">
            {{ msg.senderUsername }}
          </span>
          • {{ msg.timestamp | date: 'shortTime' }}
        </div>
      </div>
    </div>
  </div>

  <!-- 📨 Message Input -->
  <form
    [formGroup]="messageForm"
    (ngSubmit)="sendMessage()"
    class="p-3 bg-white shadow flex items-center gap-2"
  >
    <input
      type="text"
      formControlName="content"
      placeholder="Type a message..."
      class="flex-1 border border-gray-300 rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
    />
    <button
      type="submit"
      [disabled]="messageForm.invalid"
      class="bg-blue-500 hover:bg-blue-600 text-white rounded-full px-5 py-2 transition disabled:opacity-50"
    >
      Send
    </button>
  </form>
</div>
